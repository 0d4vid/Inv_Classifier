# Invoice Classifier AI Agent

This project is an AI-powered accounting automation agent that scans, analyzes, and classifies your local invoice files. It uses Google's Gemini AI to extract key information from invoice images and then organizes them into a structured format.

## Project Structure

- `app.py`: The Streamlit web application that provides a user-friendly interface for processing invoices.
- `main.py`: A command-line script for processing invoices directly from your terminal.
- `core.py`: The core logic module containing shared functions for invoice analysis, file processing, and reporting.
- `factures_a_traiter/`: The input directory where you should place your invoice images (`.png`, `.jpg`, `.jpeg`, `.webp`).
- `factures_traitees/`: The output directory where the processed and renamed invoices are moved.
- `rapport_depenses.csv`: The CSV report generated by the Streamlit application.
- `compilation.csv`: The CSV report generated by the command-line script.
- `pyproject.toml`: The project's dependency and metadata file.
- `.env`: The file to store your `GOOGLE_API_KEY`.

## Setup

1.  **Clone the repository:**
    ```bash
    git clone <repository-url>
    cd inv-classifier
    ```

2.  **Install dependencies:**
    This project uses `uv` for package management. Make sure you have it installed.
    ```bash
    pip install uv
    uv pip install -r requirements.txt
    ```
    *Alternatively, you can install the dependencies directly from `pyproject.toml` using a compatible package manager.*

3.  **Set up your environment variables:**
    Create a file named `.env` in the root of the project and add your Google API key:
    ```
    GOOGLE_API_KEY="YOUR_GOOGLE_API_KEY"
    ```

## Usage

You can use this tool in two ways: through the command-line interface or the web application.

### 1. Command-Line Interface (CLI)

The CLI is ideal for automated scripting or for users who prefer working in the terminal.

1.  **Add your invoices:**
    Place the invoice images you want to process into the `factures_a_traiter/` directory.

2.  **Run the script:**
    ```bash
    python main.py
    ```

The script will process all the images in the input folder, move them to the output folder with a new name, and generate a `compilation.csv` file with the extracted data.

### 2. Web Application (Streamlit)

The web application provides a visual and interactive way to process your invoices.

1.  **Add your invoices:**
    Place the invoice images you want to process into the `factures_a_traiter/` directory.

2.  **Launch the application:**
    ```bash
    streamlit run app.py
    ```

3.  **Use the interface:**
    - The application will open in your web browser.
    - You will see the list of invoices to be processed.
    - Click the "LANCER L'AGENT IA" button to start the processing.
    - The application will show the progress and the results. A `rapport_depenses.csv` file will be generated.

## Configuration

You can configure the input and output folders by modifying the following variables in the `core.py` file:

- `DOSSIER_INPUT`: The input directory for invoices.
- `DOSSIER_OUTPUT`: The output directory for processed invoices.
- `FICHIER_CSV_APP`: The name of the CSV report for the Streamlit app.
- `FICHIER_CSV_MAIN`: The name of the CSV report for the CLI script.

The prompt sent to the Gemini API can also be modified in the `get_prompt()` function in `core.py`.
